var models = require('config/models');
var mongoose = require('mongoose');

exports.user_profile_profile = function(user_target_name, username, callback){
	var find = function(collect, query, callback){
		mongoose.connection.db.collection(collect, function (err, collection) {
		    collection.find(query).toArray(callback);
		    });
	}
	var profile = "profile_" + user_target_name;
	if(username == user_target_name){
		find(profile, {username : user_target_name}, function(err, docs){
			if(docs.length != 0){
				var name = docs.username;
				var gender = docs.gender;
				var age = docs.age;
				var school_name = docs.school_name;
				var company_name = docs.company_name;
				var favorite = docs.favorite;
				var relationship_status = docs.relationship_status;
				var address = docs.address;
				callback({'response' : 'user profile', 'username' : name, 'gender' : gender, 'age' : age,
				'school_name' : school_name, 'company_name' : company_name, 'favorite' : favorite, 
				'relationship_status' : relationship_status, 'address' : address});
			}
		})
	}else{
		find(profile, {username : user_target_name}, function(err, docs){
			if(docs.length != 0){
				var school_name = docs.school_name;
				var company_name = docs.company_name;
				var favorite = docs.favorite;
				var relationship_status = docs.relationship_status;
				var address = docs.address;
				callback({'response' : 'guest profile', 'school_name' : school_name, 'company_name' : company_name, 'favorite' : favorite, 
				'relationship_status' : relationship_status, 'address' : address})
			}
		})
	}
}
